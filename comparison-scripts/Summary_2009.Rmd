---
title: "Summary of 2009 Scenarios"
author: "Pragati Prasad"
date: "`r Sys.Date()`"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## {.tabset}


### Scenario Key
RL01 - Base scenario: no intervention  
RL02 - Vaccine  
RL03 - Antivirals  
RL04 - Vaccine and Antivirals  
RL05 - School Closure when Illness incidence > 1%  
RL06 - School Closure on Date of Availability  
RL07 - Vaccine, Antivirals, and School Closure when Illness incidence > 1%   
RL08 - Vaccine, Antivirals, and School Closure on Date of Availability   

```{r RL01, warning=FALSE, message = FALSE}

library(ggsci)
library(reshape)
library(dplyr)
library(gridExtra)
library(ggplot2)
library(egg)
library(plyr)
library(tidyr)
library(knitr)
library(kableExtra)
library(scales)

path <- "../model-forecasts/"

team.folder <- c("Columbia/COL/RL/", "Northeastern/RL/", "UTAustin/", "UVirginia/", "Imperial/", "Columbia/COL2/RL/", "Northeastern/RL2/")
team.abbrev <- c("COL", "NEU", "UTA", "UVA", "IMP", "COL2", "NEU")
file.types <- c("SymIllness", "Hosp", "Deaths", "AntiviralTX")

file.type <- file.types[1]
scn = "RL01_"
read_ill <- function(scn){
  
  cols <- c("sm.mean")

  s <- read.csv(paste0(path,team.folder[1],scn,file.type,"_",team.abbrev[1],".csv"))
  symillness <- data.frame(c(s[which(s$Agegroup == "Overall" &
                                       s$Bin_cml %in% cols),],
                             `team` = team.abbrev[1]))
  
  for(i in 2:7){
    
    if(i == 4){
      scn = gsub("RL", "RL_", scn)
    }
    if(i == 5){
      scn = gsub("_", "", scn)
      if(file.type == "Deaths"){
        file.type = "Death"
      }
    }
    if(i == 6){
      scn = paste0(scn, "_")
      if(file.type == "Death"){
        file.type = "Deaths"
      }
    }
    
    f =  paste0(path,team.folder[i],scn,file.type,"_",team.abbrev[i],".csv")
    if(i == 5){
      f =  paste0(path,team.folder[i],scn,file.type,team.abbrev[i],".csv")
    }

    if(file.exists(f)){
      s <- read.csv(f)
      if(ncol(s) > 58){
        s <- s[-1]
      }
      if(i == 7){
        team.abbrev[i] = "NEU2"
      }
      symillness <- rbind.fill(symillness, 
                               data.frame(c(s[which(s$Agegroup == "Overall" & 
                                                      s$Bin_cml %in% cols),],`team` = team.abbrev[i])))
    }
    
  }
  symillness$Peak.Magnitude[which(is.na(symillness$Peak.Magnitude))] <-
    symillness$PeakMagnitude[which(is.na(symillness$Peak.Magnitude))]
  
  symillness$Bin[which(symillness$Bin_cml == "Peak")] <- "sm.peak"
  cml <- symillness[c("Cml", "team", "Bin", "Peak.Magnitude")]
  
  return(cml)
}

tab_RL01 <- read_ill(scn = "RL01_")

# Cumulative % Ill
cml <- data.frame(`RL01` = tab_RL01$Cml)

# Peak Magnitude
peak <- data.frame(`RL01` = tab_RL01$Peak.Magnitude)

rownames(cml) <- tab_RL01$team
rownames(peak) <- tab_RL01$team

scenario <- "RL02_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL02 <- long$Cml

# Peak Magnitude
peak$RL02 = long$Peak.Magnitude

scenario <- "RL03_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL03 <- long$Cml

# Peak Magnitude
peak$RL03 = long$Peak.Magnitude

scenario <- "RL04_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL04 <- long$Cml

# Peak Magnitude
peak$RL04 = long$Peak.Magnitude

scenario <- "RL05_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL05 <- long$Cml

# Peak Magnitude
peak$RL05 = long$Peak.Magnitude

scenario <- "RL06_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL06 <- long$Cml

# Peak Magnitude
peak$RL06 = long$Peak.Magnitude

scenario <- "RL07_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL07 <- long$Cml

# Peak Magnitude
peak$RL07 = long$Peak.Magnitude

scenario <- "RL08_"
long <- read_ill(scn = scenario)

# Cumulative % Ill
cml$RL08 <- long$Cml

# Peak Magnitude
peak$RL08 = long$Peak.Magnitude
```


### Cumulative % Ill

```{r ill_1, warning=FALSE, message = FALSE}

knitr::kable(cml, digits = 2, caption = "Cumulative % Ill") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```


### Peak % Ill

```{r ill_2, warning=FALSE, message = FALSE}

knitr::kable(peak, digits = 2, caption = "Peak Magnitude Ill") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```

### Cumulative Hosps
```{r hosp_1, warning=FALSE, message = FALSE}
file.type = file.types[2]
tab_RL01 <- read_ill(scn = "RL01_")

# Cumulative Hosps
cml <- data.frame(`RL01` = tab_RL01$Cml)

# Peak Magnitude
peak <- data.frame(`RL01` = tab_RL01$Peak.Magnitude)

rownames(cml) <- tab_RL01$team
rownames(peak) <- tab_RL01$team

scenario <- "RL02_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL02 <- long$Cml

# Peak Magnitude
peak$RL02 = long$Peak.Magnitude

scenario <- "RL03_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL03 <- long$Cml

# Peak Magnitude
peak$RL03 = long$Peak.Magnitude

scenario <- "RL04_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL04 <- long$Cml

# Peak Magnitude
peak$RL04 = long$Peak.Magnitude

scenario <- "RL05_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL05 <- long$Cml

# Peak Magnitude
peak$RL05 = long$Peak.Magnitude

scenario <- "RL06_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL06 <- long$Cml

# Peak Magnitude
peak$RL06 = long$Peak.Magnitude

scenario <- "RL07_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL07 <- long$Cml

# Peak Magnitude
peak$RL07 = long$Peak.Magnitude

scenario <- "RL08_"
long <- read_ill(scn = scenario)

# Cumulative Hospitalizations per 100K
cml$RL08 <- long$Cml

# Peak Magnitude
peak$RL08 = long$Peak.Magnitude

knitr::kable(cml, digits = 2, caption = "Cumulative Hospitalizations per 100K") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

### Peak Hosps

```{r hosp_2, warning=FALSE, message = FALSE}

knitr::kable(peak, digits = 2, caption = "Peak Hospitalizations per 100K") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```


### Cumulative Deaths
```{r death_1, warning=FALSE, message = FALSE}
file.type = file.types[3]
tab_RL01 <- read_ill(scn = "RL01_")

# Cumulative Hosps
cml <- data.frame(`RL01` = tab_RL01$Cml)

# Peak Magnitude
peak <- data.frame(`RL01` = tab_RL01$Peak.Magnitude)

rownames(cml) <- tab_RL01$team
rownames(peak) <- tab_RL01$team

scenario <- "RL02_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL02 <- long$Cml

# Peak Magnitude
peak$RL02 = long$Peak.Magnitude

scenario <- "RL03_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL03 <- long$Cml

# Peak Magnitude
peak$RL03 = long$Peak.Magnitude

scenario <- "RL04_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL04 <- long$Cml

# Peak Magnitude
peak$RL04 = long$Peak.Magnitude

scenario <- "RL05_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL05 <- long$Cml

# Peak Magnitude
peak$RL05 = long$Peak.Magnitude

scenario <- "RL06_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL06 <- long$Cml

# Peak Magnitude
peak$RL06 = long$Peak.Magnitude

scenario <- "RL07_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL07 <- long$Cml

# Peak Magnitude
peak$RL07 = long$Peak.Magnitude

scenario <- "RL08_"
long <- read_ill(scn = scenario)

# Cumulative Deaths per 100K
cml$RL08 <- long$Cml

# Peak Magnitude
peak$RL08 = long$Peak.Magnitude

knitr::kable(cml, digits = 2, caption = "Cumulative Deaths per 100K") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

### Peak Deaths

```{r death_2, warning=FALSE, message = FALSE}

knitr::kable(peak, digits = 2, caption = "Peak Deaths per 100K") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```

### Cumulative % Antivirals
```{r av_1, warning=FALSE, message = FALSE}
file.type = file.types[4]
tab_RL03 <- read_ill(scn = "RL03_")

# Cumulative Hosps
cml <- data.frame(`RL03` = tab_RL03$Cml)

# Peak Magnitude
peak <- data.frame(`RL03` = tab_RL03$Peak.Magnitude)

rownames(cml) <- tab_RL03$team
rownames(peak) <- tab_RL03$team

scenario <- "RL04_"
long <- read_ill(scn = scenario)

# Cumulative Antivirals 
cml$RL04 <- long$Cml

# Peak Magnitude
peak$RL04 = long$Peak.Magnitude

scenario <- "RL07_"
long <- read_ill(scn = scenario)

# Cumulative Antivirals 
cml$RL07 <- long$Cml

# Peak Magnitude
peak$RL07 = long$Peak.Magnitude

scenario <- "RL08_"
long <- read_ill(scn = scenario)

# Cumulative Antivirals 
cml$RL08 <- long$Cml

# Peak Magnitude
peak$RL08 = long$Peak.Magnitude

knitr::kable(cml, digits = 2, caption = "Cumulative % Antivirals") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

### Peak % Antivirals

```{r av_2, warning=FALSE, message = FALSE}

knitr::kable(peak, digits = 2, caption = "Peak % Antivirals") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```